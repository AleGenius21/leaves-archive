<div style="margin:0;height:100vh;overflow:hidden;">
    <!-- Container WordPress simulato (dimensioni fisse) -->
    <div style="width:100%;height:100%;" id="widget-container">
        <div id="leaves-archive-root">
            <div class="container-fluid pt-3 pb-0 px-0">
                <!-- Barra filtri - struttura statica -->
                <div id="filterBarContainer">
                    <div class="filter-bar-container">
                        <div class="filter-bar">
                            <div class="filter-group">
                                <label class="filter-label" for="filterSearch">Ricerca:</label>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text bg-white border-end-0">
                                        <i class="bi bi-search"></i>
                                    </span>
                                    <input type="text" class="form-control border-start-0" id="filterSearch" placeholder="Cerca dipendente..." aria-label="Cerca dipendente" />
                                </div>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filterType">Tipo:</label>
                                <select class="form-select form-select-sm" id="filterType" aria-label="Filtra per tipologia">
                                    <option value="">Tutti</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filterStato">Stato:</label>
                                <select class="form-select form-select-sm" id="filterStato" aria-label="Filtra per stato">
                                    <option value="">Tutti</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filterReparto">Reparto:</label>
                                <select class="form-select form-select-sm" id="filterReparto" aria-label="Filtra per reparto">
                                    <option value="">Tutti</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filterMansione">Mansione:</label>
                                <select class="form-select form-select-sm" id="filterMansione" aria-label="Filtra per mansione">
                                    <option value="">Tutti</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filterSort">Ordina:</label>
                                <select class="form-select form-select-sm" id="filterSort" aria-label="Ordina per">
                                    <option value="data-recente">Richiesta pi√π recente</option>
                                    <option value="urgenza-decrescente">Richiesta meno recente</option>
                                </select>
                            </div>
                            <div class="filter-group filter-group-reset">
                                <button type="button" class="btn-reset-filters" id="filterReset" aria-label="Reset filtri" disabled>
                                    <i class="bi bi-arrow-counterclockwise"></i>
                                    <span>Resetta filtri</span>
                                </button>
                            </div>
                        </div>
                        <div class="active-filters-container" id="activeFiltersContainer"></div>
                    </div>
                </div>

                <div class="main-container">
                    <!-- Lista richieste - struttura statica -->
                    <div class="list-section" id="listSection">
                        <div class="approval-list px-3 pt-3" id="approvalList"></div>
                    </div>

                    <!-- Pannello calendario laterale - struttura statica -->
                    <div id="detail-panel" class="detail-panel">
                        <button class="btn-close-panel" id="btnClosePanel" aria-label="Chiudi" type="button">
                            <i class="bi bi-x-lg"></i>
                        </button>
                        <div class="panel-content">
                            <div class="periodo-presets-container" id="past_periodoPresetsContainer">
                                <button type="button" class="preset-btn" data-preset="last-month">Mese scorso</button>
                                <button type="button" class="preset-btn" data-preset="last-six-month">Ultimi 6 mesi</button>
                                <button type="button" class="preset-btn" data-preset="last-year">Anno scorso</button>
                            </div>
                            <div class="periodo-presets-container" id="future_periodoPresetsContainer">
                                <button type="button" class="preset-btn" data-preset="next-week">Prossima settimana</button>
                                <button type="button" class="preset-btn" data-preset="next-15-days">Prossimi 15 giorni</button>
                                <button type="button" class="preset-btn" data-preset="next-month">Prossimo mese</button>
                            </div>
                            <div class="calendar-year-header-wrapper">
                                <div class="calendar-year-input-wrapper" aria-expanded="false">
                                    <input type="text" id="calendarYearInput" class="calendar-year-input" inputmode="numeric" pattern="[0-9\\s\\-]*" aria-label="Anno" aria-haspopup="dialog" aria-controls="yearPicker" />
                                    <span class="calendar-year-range-suffix" id="calendarYearRangeSuffix" aria-hidden="true"></span>
                                </div>
                                <div class="year-picker" id="yearPicker" role="dialog" aria-label="Scegli anno" hidden>
                                    <!-- Header e griglia anni generati da JS -->
                                </div>
                            </div>
                            <div class="calendar-container" id="calendarContainer"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

	
    <!-- Carica CSS e JS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="components/approval-row/approval-row.css">
    <link rel="stylesheet" href="components/filters/filters.css">
    <link rel="stylesheet" href="components/calendars/calendars.css">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>

    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/store.js"></script>

    <script src="components/approval-row/approval-row.js"></script>
    <script src="components/filters/filters.js"></script>
    <script src="components/calendars/calendars.js"></script>
    <script src="js/main.js"></script>

    <script>

		function initWidget() {
			// Definire container nel quale inserirsi
            const container = document.getElementById('widget-container');
            if (!container) return console.error("Container mancante");

			const store = hrStore();

            initLeavesArchive(container, store);

            initFilters({
                store: store,
                api: store.getState('api'),
                settings: { type: 'ferie_permessi' }
            });

            initCalendars({
                store: store,
                root: store.getState('root'),
                selectors: { container: '#calendarContainer' }
            });

            initApprovalRow({ store: store });

            console.log("Widget avviato in modo sincrono");
        }

		initWidget();
    </script>
</div>
